(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{135:function(e,t){},141:function(e,t,a){"use strict";a.r(t);var n,r=a(0),o=a.n(r),c=a(9),l=a.n(c),s=a(19),i=function(e){return fetch("/users/login",{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return 401!==e.status?e.json().then((function(e){return e})):{isAuthenticated:!1,user:{username:"",role:""}}}))},u=function(e){return fetch("/users/register",{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){return e}))},m=function(){return fetch("http://localhost:5000/users/logout").then((function(e){return 401!==e.status?e.json().then((function(e){return e})):{user:{username:"",role:""},success:!1}}))},h=function(){return fetch("http://localhost:5000/users/authenticated").then((function(e){return 401!==e.status?e.json().then((function(e){return e})):{isAuthenticated:!1,user:{username:"",role:""}}})).then((function(e){return e}))},d=a(10),p=Object(r.createContext)(),g=function(e){var t=e.children,a=Object(r.useState)(null),n=Object(d.a)(a,2),c=n[0],l=n[1],s=Object(r.useState)(!1),i=Object(d.a)(s,2),u=i[0],m=i[1],g=Object(r.useState)(!1),f=Object(d.a)(g,2),b=f[0],E=f[1];return Object(r.useEffect)((function(){h().then((function(e){l(e.user),m(e.isAuthenticated),E(!0)}))}),[]),o.a.createElement("div",null,b?o.a.createElement(p.Provider,{value:{user:c,setUser:l,isAuthenticated:u,setIsAuthenticated:m}},t):o.a.createElement("h1",null," Loading"))},f=function(e){var t=Object(r.useContext)(p),a=t.isAuthenticated,n=t.user,c=t.setIsAuthenticated,l=(t.setUser,function(){m().then((function(e){console.log(e),a&&c(!1)}))});return o.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},console.log(n),o.a.createElement(s.b,{to:"/"},o.a.createElement("div",{className:"navbar-brand"}," Navbar ")),o.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarText"},o.a.createElement("ul",{className:"navbar-nav mr-auto"},console.log(a+"Check"),a?o.a.createElement(o.a.Fragment,null,o.a.createElement(s.b,{to:"/"},o.a.createElement("li",{className:"nav-item nav-link"},"Home")),o.a.createElement(s.b,{to:"/chats"},o.a.createElement("li",{className:"nav-item nav-link"},"Chats")),"admin"===n.role?o.a.createElement(s.b,{to:"/admin"},o.a.createElement("li",{className:"nav-item nav-link"},"Admin")):null,o.a.createElement("button",{type:"button",className:"btn btn-link nav-item nav-link",onClick:l},"Logout")):o.a.createElement(o.a.Fragment,null,o.a.createElement(s.b,{to:"/"},o.a.createElement("li",{className:"nav-item nav-link"},"Home")),o.a.createElement(s.b,{to:"/login"},o.a.createElement("li",{className:"nav-item nav-link"},"Login")),o.a.createElement(s.b,{to:"/register"},o.a.createElement("li",{className:"nav-item nav-link"},"Register"))))))},b=a(12),E=a(22),v=a(86),j=a(20),y=a(84),O=a.n(y),w=o.a.createContext(),x={RoomChat1:[{from:"anubha",msg:"hello"},{from:"sona",msg:"hello"},{from:"anula",msg:"hi"}],RoomChat2:[{from:"arron",msg:"hello"},{from:"arron",msg:"hello"},{from:"arron",msg:"hello"}]};function N(e,t){var a=t.payload,n=a.from,r=a.msg,o=a.topic,c=a.typing;switch(t.type){case"RECEIVE_MESSAGE":if(!c)return Object(j.a)(Object(j.a)({},e),{},Object(E.a)({},o,[].concat(Object(v.a)(e[o]),[{from:n,msg:r}])));default:return e}}var C=0,S=function(e){console.log("ssend: "+JSON.stringify(e)),n.emit("chat message",e)};function k(e){var t=e.user,a=e.check,r=o.a.useReducer(N,x),c=Object(d.a)(r,2),l=c[0],s=c[1],i=o.a.useState({from:"",typing:"false"}),u=Object(d.a)(i,2),m=u[0],h=u[1];return n||(n=O()(":3001"),console.log("Hi"),C=1),0!=C&&C<2&&(n.on("chat message",(function(e){h({from:e.from,typing:e.typing}),s({type:"RECEIVE_MESSAGE",payload:e}),console.log("JJJ")})),C++),o.a.createElement("div",null,console.log(l),o.a.createElement(w.Provider,{value:{totalChats:l,sendChat:S,user:t,typingStatus:m,checkMessage:a}},e.children))}var A=a(166),B=a(169),R=a(48),I=a(171),U=a(172),J=a(173),P=a(176),T=a(174),F=a(175),L=Object(A.a)((function(e){return{root:{padding:e.spacing(3,3)},flex:{display:"flex",alignItems:"center"},text:{color:"#0000A0"},topicwindow:{width:"30%",height:"300px",borderRight:"1px solid grey"},chatwindow:{width:"70%",height:"300px",padding:"20px"},chatBox:{width:"85%"},button:{width:"15%"}}}));function H(){var e=o.a.useContext(w),t=e.totalChats,a=e.sendChat,n=e.user,c=e.typingStatus,l=(e.checkMessage,Object.keys(t)),s=L(),i=Object(r.useState)(l[0]),u=Object(d.a)(i,2),m=u[0],h=u[1],p=Object(r.useState)(""),g=Object(d.a)(p,2),f=g[0],b=g[1],E=Object(r.useState)(c.from),v=Object(d.a)(E,2),j=(v[0],v[1]);return o.a.createElement("div",{className:s.root},o.a.createElement(B.a,{elevation:5},o.a.createElement(R.a,{variant:"h2",component:"h3",gutterBottom:!0},"Chat App"),o.a.createElement(R.a,{variant:"h4",component:"h4",gutterBottom:!0},m),o.a.createElement("div",{className:s.flex},o.a.createElement("div",{className:s.topicwindow},o.a.createElement(I.a,null,l.map((function(e){return o.a.createElement(U.a,{onClick:function(e){return h(e.target.innerText)},key:e,button:!0},o.a.createElement(J.a,{primary:e}))})))),o.a.createElement("div",{className:s.chatwindow},t[m].map((function(e,t){return o.a.createElement("div",{className:s.flex,key:t},o.a.createElement(P.a,{label:e.from,className:s.chip}),o.a.createElement(R.a,{variant:"body1",gutterBottom:!0}," ",e.msg," "))})))),o.a.createElement("div",{className:s.flex},o.a.createElement(F.a,{id:"standard-name",label:"Send a chat",className:s.chatBox,value:f,onChange:function(e){b(e.target.value),a({from:n,typing:!0})}}),o.a.createElement(T.a,{variant:"contained",color:"primary",onClick:function(){a({from:n,msg:f,topic:m,typing:!1}),b(""),j("")}},"Send")),o.a.createElement("div",{className:s.text},c.typing&&o.a.createElement("p",null,c.from," is typing"))))}Object(A.a)((function(e){return{root:{padding:e.spacing(3,2)},flex:{display:"flex",alignItems:"center"},topicwindow:{width:"30%",height:"300px",borderRight:"1px solid grey"},chatwindow:{width:"70%",height:"300px",padding:"20px"},chatBox:{width:"85%"},button:{width:"15%"}}}));var M=function(){return fetch("/users/chats").then((function(e){return 401!==e.status?e.json().then((function(e){return e})):{message:{msgBody:"UnAuthorized"},msgError:!0}})).catch((function(e){console.log(e)}))},z=function(e){return fetch("/users/chat",{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return 401!==e.status?e.json().then((function(e){return e})):{message:{msgBody:"UnAuthorized"},msgError:!0}})).catch((function(e){console.log(e)}))},D=function(e){var t="alert ";return e.message.msgError?t+="alert-danger":t+="alert-primary",t+" text-center"},_=function(e){return o.a.createElement("div",{className:D(e),role:"alert"},e.message.msgBody)},G=Object(A.a)((function(e){return{root:{padding:e.spacing(3,2)},flex:{display:"flex",alignItems:"center"},topicwindow:{width:"30%",height:"300px",borderRight:"1px solid grey"},chatwindow:{width:"70%",height:"300px",padding:"20px"},chatBox:{width:"85%"},button:{width:"15%"}}})),V=function(e){var t=Object(r.useState)({name:""}),a=Object(d.a)(t,2),n=a[0],c=a[1],l=Object(r.useState)([]),s=Object(d.a)(l,2),i=(s[0],s[1]),u=Object(r.useState)(null),m=Object(d.a)(u,2),h=m[0],g=m[1],f=Object(r.useState)(""),b=Object(d.a)(f,2),E=(b[0],b[1]),v=Object(r.useState)([]),j=Object(d.a)(v,2),y=j[0],O=j[1],w=Object(r.useContext)(p),x=Object(r.useState)(y[0]),N=Object(d.a)(x,2),C=N[0],S=N[1],k=G();Object(r.useEffect)((function(){M().then((function(e){i(e.chats)}))}),[]);return o.a.createElement("div",{className:k.root},o.a.createElement(R.a,{variant:"h2",component:"h3",gutterBottom:!0},"List of all registered user"),o.a.createElement(R.a,{variant:"h4",component:"h4"},C),o.a.createElement(I.a,null,y.map((function(e){return o.a.createElement(U.a,{onClick:function(e){return S(e.target.innerText)},key:e._id,button:!0},o.a.createElement(J.a,{primary:e.username}))}))),o.a.createElement(T.a,{variant:"contained",color:"primary",onClick:function(e){e.preventDefault(),z(n).then((function(e){console.log(e);var t=e.message;c({name:""}),t.msgError?"UnAuthorized"===t.msgBody?(g(t),w.setUser({username:"",role:""}),w.setIsAuthenticated(!1)):g(t):M().then((function(e){console.log(e),E(e.user),i(e.chats),O(e.list),g(t)}))}))}},"Want to see list of all registered user"),h&&o.a.createElement(_,{message:h}))};function W(){var e=o.a.useContext(p),t=e.user,a=(e.setUser,e.isAuthenticated);e.setIsAuthenticated;return o.a.createElement("div",null,a?o.a.createElement(k,{user:t.username,check:a},console.log("Hello"),console.log(t),o.a.createElement(V,null),o.a.createElement(H,null)):o.a.createElement("h1",null,"Please First Login to Chat"))}var q=function(e){var t=Object(r.useState)({username:"",password:""}),a=Object(d.a)(t,2),n=a[0],c=a[1],l=Object(r.useState)(null),s=Object(d.a)(l,2),u=s[0],m=s[1],h=Object(r.useContext)(p),g=function(e){c(Object(j.a)(Object(j.a)({},n),{},Object(E.a)({},e.target.name,e.target.value)))};return o.a.createElement("div",null,o.a.createElement("form",{onSubmit:function(t){t.preventDefault(),i(n).then((function(t){var a=t.isAuthenticated,n=t.user,r=t.message;console.log(n.username),a?(h.setUser(n),h.setIsAuthenticated(a),console.log(e),e.history.push("/chats")):m(r)}))}},o.a.createElement("h2",null,"Please Sign-in"),o.a.createElement("label",{htmlFor:"username",className:"sr-only"}," Username: "),o.a.createElement("input",{type:"text",name:"username",onChange:g,className:"form-control",placeholder:"Enter userName"}),o.a.createElement("label",{htmlFor:"password",className:"sr-only"}," Password: "),o.a.createElement("input",{type:"password",name:"password",onChange:g,className:"form-control",placeholder:"Enter Password"}),o.a.createElement("button",{className:"btn btn-lg btn-primary btn-block",type:"submit"},"Login")),u?o.a.createElement(_,{message:u}):null)},K=function(e){var t=Object(r.useState)({username:"",password:"",role:""}),a=Object(d.a)(t,2),n=a[0],c=a[1],l=Object(r.useState)(null),s=Object(d.a)(l,2),i=s[0],m=s[1],h=Object(r.useRef)(null);Object(r.useEffect)((function(){return function(){return clearTimeout(h)}}),[]);var p=function(e){c(Object(j.a)(Object(j.a)({},n),{},Object(E.a)({},e.target.name,e.target.value)))};return o.a.createElement("div",null,o.a.createElement("form",{onSubmit:function(t){t.preventDefault(),u(n).then((function(t){console.log(t);var a=t.message;m(a),c({username:"",password:"",role:""}),a.msgError||(h=setTimeout((function(){e.history.push("/login")}),2e3))}))}},o.a.createElement("h2",null,"Please Signup"),o.a.createElement("label",{htmlFor:"username",className:"sr-only"}," Username: "),o.a.createElement("input",{type:"text",name:"username",value:n.username,onChange:p,className:"form-control",placeholder:"Enter userName"}),o.a.createElement("label",{htmlFor:"password",className:"sr-only"}," Password: "),o.a.createElement("input",{type:"password",name:"password",value:n.password,onChange:p,className:"form-control",placeholder:"Enter Password"}),o.a.createElement("input",{type:"text",name:"role",value:n.role,onChange:p,className:"form-control",placeholder:"Enter Role"}),o.a.createElement("button",{className:"btn btn-lg btn-primary btn-block",type:"submit"},"Register")),i?o.a.createElement(_,{message:i}):null)};var Q=function(){return o.a.createElement(s.a,null,o.a.createElement(f,null),o.a.createElement(b.a,{exact:!0,path:"/",component:W}),o.a.createElement(b.a,{path:"/login",component:q}),o.a.createElement(b.a,{path:"/register",component:K}),o.a.createElement(b.a,{path:"/chats",component:W}))};l.a.render(o.a.createElement(g,null,o.a.createElement(Q,null)),document.getElementById("root"))},97:function(e,t,a){e.exports=a(141)}},[[97,1,2]]]);
//# sourceMappingURL=main.9a075000.chunk.js.map